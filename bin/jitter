#!/usr/bin/env python3

import sys
import random

usage = """
jitter - introduces chance to your pipeline

Examples:

	# 50% chance of exit code 0
	jitter

	# 33% chance of exit code 0
	jitter 0.33

	# 33% chance of exit code 0, only first argument is used
	jitter 0.33 0.44 0.55

	# exit code 3, invalid argument, it should be a float/int
	jitter hello

	# exit code 5, shows this help
	jitter --help
"""

if len(sys.argv) == 2:
	if sys.argv[1] in ('-h', '--help'):
		print(usage, file=sys.stderr)
		exit_code = 5
	else:
		try:
			chance = float(sys.argv[1])
			exit_code = 0 if random.random() >= chance else 1
		except:
			exit_code = 3
else:
	exit_code = random.choice([0, 1])
print("%d" % exit_code, file=sys.stderr)
sys.exit(exit_code)
